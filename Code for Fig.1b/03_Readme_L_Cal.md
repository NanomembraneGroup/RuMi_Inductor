# corecode.m: Inductance and Mutual Inductance Calculation

**`corecode.m`** 

computes the magnetic field distribution and related **inductance** (*L*) and **mutual inductance** (*M*) for a coil system with varying turns (*n*). It defines key parameters such as conductor width (*w*), thickness (*h*), coil radius (*R*), and relative permeability (*μr*). The key sections are:

## 1. Parameter Initialization
Defines coil parameters:
- **Width (`w`)**, **Height (`h`)**, **Radius (`R`)**  
- **Relative Permeability (`mu_r`)**, **Thickness (`T`)**, **Number of turns (`turns`)**

## 2. Index List Construction
- A nested loop generates `(k, j)` pairs while ensuring `k ≤ j` to avoid redundant calculations.  
- These pairs are stored in `indexList`.

## 3. Magnetic Field Calculation (Parallel Processing)
- A `parfor` loop computes the magnetic field for each `(k, j)` pair.
- Results are stored in `result1` and `result2`, then reconstructed into symmetric matrices `Bz_avg1_3D` and `Bz_avg2_3D`.

## 4. Inductance & Mutual Inductance Calculation
- **`L3`, `L4`, `M3`, `M4`**: Computed based on **width (`w`)** effects.
- **`L5`, `L6`, `M5`, `M6`**: Computed based on **radius (`R`)** effects.
- Uses functions like:
  - `L1()`, `Mc1()`: Magnetic calculations.
  - `L_magnetic()`, `Zp_t()`: Further physical computations.

## 5. Plotting
- **First subplot**: `L3`, `L4`, `M3`, `M4` vs. `l_tot_1`
- **Second subplot**: `L5`, `L6`, `M5`, `M6` vs. `l_tot_2`

## **Function Descriptions**

### **L1.m**
- Calculates inductance (*L*) for a conductor of length *l*, considering width (*a*), thickness (*b*), and a correction factor (*T*).

### **Mc1.m**
- Computes mutual inductance (*M*) between two conductors using the vacuum permeability (*μ0*) and their relative spacing (*r*).

### **L_magnetic.m**
- Calculates the inductance contribution from magnetic effects.
- Defines the vacuum permeability (*μ0*) and computes a characteristic length scale *λ* based on gap (*g*), thickness (*t_m*), and relative permeability (*μr*).
- Uses the **tanh function** to model magnetic flux distribution across width (*w*).
- Computes final inductance (*L*) using *μ0*, *μr*, *t_m*, *l*, and **tanh-term scaling**.

### **magnetic_field_z.m**
- Calculates the **z-component of the magnetic field** (*B_z*) at a given point (*r, θ, z*) generated by a current cylinder using the **Biot-Savart law**.
#### **Steps:**
1. **Initialize Constants:**  
   - Defines total current (*I*), vacuum permeability (*μ0*), and discretization steps for coil thickness (*t*) and height (*h*).

2. **Loop Over Coil Geometry:**  
   - **Divides the coil into small current loops** at different heights and thicknesses.  
   - Each loop is discretized into **30 small segments**.

3. **Compute Magnetic Field:**  
   - Converts cylindrical coordinates (*r, θ*) to Cartesian (*x, y, z*).  
   - **Uses the Biot-Savart law** to compute the contribution of each segment.  
   - **Summarizes the z-component** of the magnetic field.
